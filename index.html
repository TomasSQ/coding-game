<html>
	<head>
		<script
	src="http://code.jquery.com/jquery-3.2.1.min.js"
	integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	crossorigin="anonymous"></script>
		<link rel="stylesheet" href="css/codemirror.css">
		<link rel="stylesheet" href="css/pastel-on-dark.css">
		<link rel="stylesheet" href="css/tetris.css">
		<link rel="stylesheet" href="css/tsp.css">
		<link rel="stylesheet" href="css/coding-game.css">
		<link href="https://fonts.googleapis.com/css?family=Open+Sans|Patua+One" rel="stylesheet">
		<link rel="stylesheet" href="http://fontawesome.io/assets/font-awesome/css/font-awesome.css">
		<script type="text/javascript" src="js/codemirror.js"></script>
		<script type="text/javascript" src="js/show-hint.js"></script>
		<script type="text/javascript" src="js/javascript-hint.js"></script>
		<script type="text/javascript" src="js/javascript.js"></script>
		<script type="text/javascript" src="js/markdown.js"></script>
		<style>
			body {
				margin: 0;
				padding: 0;
				width: 100vw;
				font-family: 'Open Sans', sans-serif;
			}
		</style>
	</head>
	<body>
		<div class="left-side">
			<div class="game-info">
				<h1><span><i class="fa fa-code"></i></span> DexCoding</h1>
				<div class="game-score">
					<i class="fa fa-thermometer"></i>
					<div class="round">
						<small class="item-label">round</small> 10
					</div>
					<div class="score">
						<small class="item-label">score</small> 10
					</div>
				</div>
			</div>
			<div class="canvas">
				<div class="character player"></div>
				<div class="character enemy"></div>
				<div class="character enemy"></div>
			</div> 
		</div><div class="right-side">
			<div class="game-buttons">
				<button><i class="fa fa-cogs"></i> run code</button>
			</div>
			<textarea id="code">
for (let i = 0; i < lib.targets.length; i++) {
  if (!lib.targets[i].dead) {
    lib.player.moveTo(lib.targets[i].coord)
    break
  }
}
lib.goToColumn(1+Math.floor(Math.random()*6))
lib.rotate()
			</textarea>
		</div>
		<script>
			window.lib = {}
		</script>
		<script src="js/tsp.js"></script>
		<script src="js/tetris.js"></script>
		<script>
			(function() {
				function getParameterByName(name, url) {
					if (!url) url = window.location.href;
					name = name.replace(/[\[\]]/g, "\\$&");
					var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
						results = regex.exec(url);
					if (!results) return null;
					if (!results[2]) return '';
					return decodeURIComponent(results[2].replace(/\+/g, " "));
				}

				let game = getParameterByName('game') || 'tsp'
				let d
				const execRound = (code) => {
					if (window.lib[game].hasEnded()) {
						$('body').find('.overlay, video').fadeIn();
						return;
					}
					eval('(function(lib){'+code+'})(window.lib[\''+game+'\'])')
					window.lib[game].redraw()
					d = setTimeout(() => execRound(code), 1000)
				}
				$('button').click(() => {
					if (d) clearInterval(d)
					window.lib[game].init($('.canvas'))
					execRound(window.editor.getValue())
				})

				if (game === 'tetris') {
					window.lib.tetris.mountDriver()
				}
			})()
		</script>
		<script type="text/javascript" src="js/code-editor.js"></script>
		<video alt=" rap snoop dogg thug life 50cent GIF" src="https://media.giphy.com/media/UomtITuXq8kvK/giphy.mp4" poster="https://media.giphy.com/media/UomtITuXq8kvK/giphy_s.gif" autoplay="" loop="" playsinline="" style="width: 60%; height: 60%;"></video>
		<div class="overlay">click to close</div>
	</body>
</html>
